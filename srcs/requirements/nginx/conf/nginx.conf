# üîÅ Redirecci√≥n HTTP ‚Üí HTTPS
server {
    listen 80;
    server_name ngastana.42.fr;
    return 301 https://$host$request_uri;
}

# üîê Bloque principal HTTPS
server{
	listen 443 ssl; #listen in 443 port(HTTPS) and uses ssl to encrypt communication

	server_name ngastana.42.fr;

	#paths for private key and SSL certificates files
	ssl_certificate_key /etc/nginx/ssl/ngastana.key;
	ssl_certificate		/etc/nginx/ssl/ngastana.crt;

	ssl_protocols TLSv1.3; #only TLS v1.3 protocols should be used for secure communication.

	root /var/www/html; #sets root directory for web server
	index index.html index.php; #will attempt to load index.php

#aqui nginx detecta que es un archivo .php, entonces en vez de servir como archivo HTML pasa a PHP-FPM
	location ~[^/]\\.php(/|$){ #
		fastcgi_pass wordpress:9000; #Oye, este archivo PHP no lo sirvo yo, p√°saselo a PHP-FPM que est√° corriendo en el contenedor WordPress en el puerto 9000.
		fastcgi_index index.php; #Nginx qu√© archivo usar por defecto si un directorio se solicita en la URL.
		fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; #incluye un archivo de configuraci√≥n de FastCGI est√°ndar que viene con Nginx.
		include fastcgi_params; #PHP-FPM la ruta exacta del archivo PHP a ejecutar.
	}
}